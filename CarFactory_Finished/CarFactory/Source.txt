#include "head.h"

// =====================================================
// ===============  TIRES FUNCTIONS  ===================
// =====================================================

void createListTire(ListTire &L) {
    L.firstTire = nullptr;
}

bool isEmptyTire(ListTire L) {
    return L.firstTire == nullptr;
}

void addTire(ListTire &L) {
    adrTire P = new eleTire;

    cout << "\n=== Input Tire ===\n";
    cout << "Nama Tire     : ";
    cin >> P->info.name;
    cout << "Size          : ";
    cin >> P->info.size;
    cout << "Type          : ";
    cin >> P->info.type;
    cout << "Price         : ";
    cin >> P->info.price;

    P->next = nullptr;
    P->prev = nullptr;

    if (isEmptyTire(L)) {
        L.firstTire = P;
    } else {
        adrTire Q = L.firstTire;
        while (Q->next != nullptr) Q = Q->next;
        Q->next = P;
        P->prev = Q;
    }

    cout << "Tire added!\n";
}

void deleteTire(ListTire &L) {
    if (isEmptyTire(L)) {
        cout << "No tire to delete.\n";
        return;
    }

    adrTire P = L.firstTire;
    L.firstTire = P->next;
    if (P->next != nullptr) P->next->prev = nullptr;

    delete P;
    cout << "First tire deleted.\n";
}

void displayTire(ListTire L) {
    if (isEmptyTire(L)) {
        cout << "No Tire Data.\n";
        return;
    }

    adrTire P = L.firstTire;
    cout << "\n=== Tire List ===\n";
    while (P != nullptr) {
        cout << "- " << P->info.name << " | Size: " << P->info.size
             << " | Type: " << P->info.type << " | Price: " << P->info.price << "\n";
        P = P->next;
    }
}

// =====================================================
// ===============  ENGINE FUNCTIONS  ==================
// =====================================================

void createListEngine(ListEngine &L) {
    L.firstEngine = nullptr;
}

bool isEmptyEngine(ListEngine L) {
    return L.firstEngine == nullptr;
}

void addEngine(ListEngine &L) {
    adrEngine P = new eleEngine;

    cout << "\n=== Input Engine ===\n";
    cout << "Nama Engine   : ";
    cin >> P->info.name;
    cout << "Horsepower    : ";
    cin >> P->info.horsepower;
    cout << "Fuel Type     : ";
    cin >> P->info.fuel;
    cout << "Price         : ";
    cin >> P->info.price;

    P->next = nullptr;
    P->prev = nullptr;

    if (isEmptyEngine(L)) {
        L.firstEngine = P;
    } else {
        adrEngine Q = L.firstEngine;
        while (Q->next != nullptr) Q = Q->next;
        Q->next = P;
        P->prev = Q;
    }
    cout << "Engine added!\n";
}

void deleteEngine(ListEngine &L) {
    if (isEmptyEngine(L)) {
        cout << "No engine to delete.\n";
        return;
    }

    adrEngine P = L.firstEngine;
    L.firstEngine = P->next;

    if (P->next != nullptr) P->next->prev = nullptr;
    delete P;

    cout << "First engine deleted.\n";
}

void displayEngine(ListEngine L) {
    if (isEmptyEngine(L)) {
        cout << "No Engine Data.\n";
        return;
    }

    adrEngine P = L.firstEngine;
    cout << "\n=== Engine List ===\n";
    while (P != nullptr) {
        cout << "- " << P->info.name << " | HP: " << P->info.horsepower
             << " | Fuel: " << P->info.fuel << " | Price: " << P->info.price << "\n";
        P = P->next;
    }
}

// =====================================================
// ===============  FRAMEWORK FUNCTIONS  ===============
// =====================================================

void createListFK(ListFK &L) {
    L.firstFK = nullptr;
}

bool isEmptyFK(ListFK L) {
    return L.firstFK == nullptr;
}

void addFK(ListFK &L) {
    adrFK P = new eleFK;

    cout << "\n=== Input Framework ===\n";
    cout << "Name          : ";
    cin >> P->info.name;
    cout << "Model         : ";
    cin >> P->info.model;
    cout << "Material      : ";
    cin >> P->info.material;
    cout << "Price         : ";
    cin >> P->info.price;

    P->next = nullptr;
    P->prev = nullptr;

    if (isEmptyFK(L)) {
        L.firstFK = P;
    } else {
        adrFK Q = L.firstFK;
        while (Q->next != nullptr) Q = Q->next;
        Q->next = P;
        P->prev = Q;
    }

    cout << "Framework added!\n";
}

void deleteFK(ListFK &L) {
    if (isEmptyFK(L)) {
        cout << "No framework to delete.\n";
        return;
    }

    adrFK P = L.firstFK;
    L.firstFK = P->next;
    if (P->next != nullptr) P->next->prev = nullptr;

    delete P;
    cout << "First framework deleted.\n";
}

void displayFK(ListFK L) {
    if (isEmptyFK(L)) {
        cout << "No Framework Data.\n";
        return;
    }

    adrFK P = L.firstFK;
    cout << "\n=== Framework List ===\n";
    while (P != nullptr) {
        cout << "- " << P->info.name << " | Model: " << P->info.model
             << " | Material: " << P->info.material << " | Price: " << P->info.price << "\n";
        P = P->next;
    }
}

// =====================================================
// ================== CAR FUNCTIONS  ===================
// =====================================================

void createListCar(ListCar &L) {
    L.firstCar = nullptr;
}

bool isEmptyCar(ListCar L) {
    return L.firstCar == nullptr;
}

void addCar(ListCar &L, ListEngine &LE, ListFK &LF, ListTire &LT) {
    adrCar P = new eleCar;
    adrEngine e = LE.firstEngine;
    adrFK fk = LF.firstFK;
    adrTire t = LT.firstTire;
    string input;

    cout << "\n=== Input Car ===\n";
    cout << "Car Name: ";
    cin >> input;
    P->info.name = input;

    // Car creation requires components
    bool n = false;
    while (n != true){
        cout << "\nSelect Engine : ";
        cin >> input;
        while(e != nullptr){
            if(e->info.name == input){
                P->info.carEngine = e;
                n = true;
            }
            e = e->next;
        }
        if(n == false){
            cout << "\nEngine Doesn't Exist!" << endl;
        }
    }

    n = false;
    while (n != true){
        cout << "Select Tire: ";
        cin >> input;
        while(t != nullptr){
            if(t->info.name == input){
                P->info.carTire = t;
                n = true;
            }
            t = t->next;
        }
        if(n == false){
            cout << "\nTire Doesn't Exist!" << endl;
        }
    }

    n = false;
    while (n != true){
        cout << "Select Framework : ";
        cin >> input;
        while(fk != nullptr){
            if(fk->info.name == input){
                P->info.carFK = fk;
                n = true;
            }
            fk = fk->next;
        }
        if(n == false){
            cout << "\nFramework Doesn't Exist!" << endl;
        }
    }

    P->info.price = P->info.carEngine->info.price +
                    P->info.carTire->info.price +
                    P->info.carFK->info.price;

    P->next = nullptr;
    P->prev = nullptr;

    if (isEmptyCar(L)) {
        L.firstCar = P;
    } else {
        adrCar Q = L.firstCar;
        while (Q->next != nullptr) Q = Q->next;
        Q->next = P;
        P->prev = Q;
    }

    cout << "Car added!\n";
}

void deleteCar(ListCar &L) {
    if (isEmptyCar(L)) {
        cout << "No car to delete.\n";
        return;
    }

    adrCar P = L.firstCar;
    L.firstCar = P->next;
    if (P->next != nullptr) P->next->prev = nullptr;

    delete P;

    cout << "First car deleted.\n";
}

void displayCar(ListCar L) {
    if (isEmptyCar(L)) {
        cout << "No Car Data.\n";
        return;
    }

    adrCar P = L.firstCar;
    cout << "\n=== Car List ===\n";
    while (P != nullptr) {
        cout << "- " << P->info.name
             << " | Total Price: " << P->info.price
             << "\n";
        P = P->next;
    }
}
